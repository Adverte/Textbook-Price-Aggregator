{% extends "base.html" %}

{% block head %}
<style type="text/css">
.book_data {
  min-height: 150px;
}
</style>

<script type="text/javascript">
$(function () {
   $.ajax({
       url:'{{ url }}',
       dataType: 'json',
       success: function(data) { 
           output_textbook(data,'div#textbook'); 
       },
       beforeSend: function(jpXHR, settings) {
           $('<div class="overlay" />').appendTo('div#content').hide();
           $('div#content').css('min-height', '300px');
           $('.overlay').fadeIn();
       },
       complete: function(jqXHR, textStatus) {
           $('.overlay').fadeOut('slow', function() {
               $('.overlay').remove()
           });
       }
   });
});

function output_textbook(data, selector)
{
        var container_id = 'textbook_info';
        var container_sel = '#' + container_id;

        $('<div id="'+container_id+'" />').hover(function() {
            $(this).addClass('highlight').css('background','orange');
        }, function() {
            $(this).removeClass('highlight').css('background','');
        }).addClass('clickable')
          .addClass('book_data')
          .appendTo(selector)
          .hide()
          .slideDown();

        var imghtml = '<img class="bookimage" src="' + data.imageurl +'"></img>';
        var linkhtml = '<a href="' + data.url +'">' + data.title + '</a>';
        $(imghtml+linkhtml).appendTo(container_sel);

        $('<hr class="clear"/>').appendTo(selector);
        $("div.clickable").click( function() {
            window.location = $(this).children('a').attr('href');
            return false;
        });
}
</script>
{% endblock head %}

{% block content %}
<div id="textbook"></div>
<div id="listings"></div>
{% endblock %}